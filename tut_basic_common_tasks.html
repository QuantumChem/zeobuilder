<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4.3. Common tasks &#8212; Zeobuilder 0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4.4. Measurements" href="tut_basic_measurements.html" />
    <link rel="prev" title="4.2. Getting started" href="tut_basic_getting_started.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tut_basic_measurements.html" title="4.4. Measurements"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tut_basic_getting_started.html" title="4.2. Getting started"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Zeobuilder 0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tut_basic.html" accesskey="U">4. Zeobuilder Tutorial &#8211; Getting started</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="common-tasks">
<h1>4.3. Common tasks<a class="headerlink" href="#common-tasks" title="Permalink to this headline">¶</a></h1>
<p>In this chapter, we use a model of dipropylether
(<a class="reference download internal" href="_downloads/dipropylether.xyz" download=""><code class="xref download docutils literal"><span class="pre">dipropylether.xyz</span></code></a>),
Silicalite-1
(<a class="reference download internal" href="_downloads/silicalite1.zml" download=""><code class="xref download docutils literal"><span class="pre">silicalite1.zml</span></code></a>),
THF
(<a class="reference download internal" href="_downloads/thf.xyz" download=""><code class="xref download docutils literal"><span class="pre">thf.xyz</span></code></a>),
and an MFI precursor model
(<a class="reference download internal" href="_downloads/precursor.zml" download=""><code class="xref download docutils literal"><span class="pre">precursor.zml</span></code></a>).</p>
<div class="section" id="adding-bonds-to-the-model">
<h2>4.3.1. Adding bonds to the model<a class="headerlink" href="#adding-bonds-to-the-model" title="Permalink to this headline">¶</a></h2>
<p>Load the file <a class="reference download internal" href="_downloads/dipropylether.xyz" download=""><code class="xref download docutils literal"><span class="pre">dipropylether.xyz</span></code></a>. Your
window should be similar to figure the figure below. Zeobuilder only shows the atoms and no
bonds because the XYZ format only contains atomic coordinates. One can easily add
bonds automatically based on a database of average bond lengths in two steps:}}</p>
<div class="figure align-center" id="id1">
<img alt="_images/zeobuilder_dipropylether.png" src="_images/zeobuilder_dipropylether.png" />
<p class="caption"><span class="caption-text">Zeobuilder with dipropylether.xyz</span></p>
</div>
<ol class="arabic simple">
<li>Select the global reference frame. The easiest way to accomplish this, is by
clicking on the first node in the tree view.</li>
<li>Activate the function <code class="docutils literal"><span class="pre">Object</span> <span class="pre">-&gt;</span> <span class="pre">Molecular</span> <span class="pre">-&gt;</span> <span class="pre">Add</span> <span class="pre">bonds</span> <span class="pre">(database)</span></code> or
press <code class="docutils literal"><span class="pre">Ctrl-B</span></code>.</li>
</ol>
<p>Zeobuilder always selects newly created objects after any operation. In this
case all the bonds are selected.</p>
<p>One might wonder why bonds are explicit objects in Zeobuilder. At first sight it
seems much simpler to draw them always automatically in the 3D view, without
listing them in the tree view. These are the reasons to choose for explicit bond
objects in Zeobuilder:</p>
<ul class="simple">
<li>The &#8216;automatic&#8217; approach implies that the internal list of bonds has to be
updated automatically each time one or more atoms are displaced. For small
models (&lt;100 atoms), this is OK, but for very large models (&gt;1000 atoms), this
becomes a CPU-consuming process and it will kill the responsiveness of the
program.</li>
<li>When preparing a model for a molecular mechanics simulation, the bond graph is
also an explicit part of the input. It is therefore useful to offer the
possibility to add or remove bonds manually.</li>
<li>In some applications, bonds are used to display the topology of the structure
at a slightly larger scale. When visualizing Zeolite models, this is a common
practice. In the figure below, the oxygen atoms are omitted and the neighboring
silicon atoms are connected by bond objects. This has been accomplished with
the menu function <code class="docutils literal"><span class="pre">Object</span> <span class="pre">-&gt;</span> <span class="pre">Molecular</span> <span class="pre">-&gt;</span> <span class="pre">Add</span> <span class="pre">bonds</span> <span class="pre">(parameters)</span></code>. Try
this, starting from the original MFI model (<a class="reference download internal" href="_downloads/silicalite1.zml" download=""><code class="xref download docutils literal"><span class="pre">silicalite1.zml</span></code></a>). The mfi model is based on the data from the
<a class="reference external" href="http://www.iza-structure.org/databases/">Zeolite atlas</a>.</li>
</ul>
<div class="figure align-center">
<img alt="_images/mfi_abstract.png" src="_images/mfi_abstract.png" />
</div>
</div>
<div class="section" id="internal-rotations">
<h2>4.3.2. Internal rotations<a class="headerlink" href="#internal-rotations" title="Permalink to this headline">¶</a></h2>
<p>In this section we will demonstrate how the hierarchical data structure of
Zeobuilder proofs to be helpful when performing internal rotations in a
molecule. Open the model <a class="reference download internal" href="_downloads/dipropylether.xyz" download=""><code class="xref download docutils literal"><span class="pre">dipropylether.xyz</span></code></a> in Zeobuilder and
add the bonds as explained in the previous section. Two types of internal
rotations will be demonstrated.</p>
<p>The first example is a rotation of a methyl top. Take the following steps:</p>
<ol class="arabic simple">
<li>Chose one of the two methyl groups in the molecule and select all atoms and
bonds of the methyl group. These kind of selections are easily made in the 3D
view by drawing a rectangle around the methyl group. Be careful not to
select other parts of the molecule by accident. One can work with the middle
and right mouse buttons to tune the selection.</li>
<li>Activate the function <code class="docutils literal"><span class="pre">Object</span> <span class="pre">-&gt;</span> <span class="pre">Arrange</span> <span class="pre">-&gt;</span> <span class="pre">Frame</span></code> or press <code class="docutils literal"><span class="pre">Ctrl-F</span></code>.
Inspect the result in the tree view: The methyl group now lives in its proper
reference frame.</li>
<li>Select the reference frame that contains the methyl group (in the tree view).
Your window should look like this figure:</li>
</ol>
<div class="figure align-center" id="id2">
<img alt="_images/zeobuilder_internal_rotation1.png" src="_images/zeobuilder_internal_rotation1.png" />
<p class="caption"><span class="caption-text">The methyl group in its proper reference frame.</span></p>
</div>
<ol class="arabic simple" start="4">
<li>Add the methyl-C bond to the current selection, i.e. click on this bond with
the middle mouse button in the 3D view.</li>
<li>Use the interactive rotate function, i.e. drag with the left mouse button
while holding the <code class="docutils literal"><span class="pre">Ctrl</span></code> key pressed. (Make sure the <code class="docutils literal"><span class="pre">Ctrl</span></code> key is pressed
before you start dragging.) You will notice that the methyl group rotates
about the C-C axis. You should get something similar to the following figure:</li>
</ol>
<div class="figure align-center" id="id3">
<img alt="_images/zeobuilder_internal_rotation1_done.png" src="_images/zeobuilder_internal_rotation1_done.png" />
<p class="caption"><span class="caption-text">The methyl group after rotation.</span></p>
</div>
<ol class="arabic simple" start="6">
<li>Select the methyl frame again in the tree view and activate the menu function
<code class="docutils literal"><span class="pre">Object</span> <span class="pre">-&gt;</span> <span class="pre">Arrange</span> <span class="pre">-&gt;</span> <span class="pre">Unframe</span> <span class="pre">(absolute)</span></code> or press <code class="docutils literal"><span class="pre">Ctrl-Shift-F</span></code>. The</li>
</ol>
<p>The second example is a rotation that changes the C-O-C bending angle. Follow
these instructions:</p>
<ol class="arabic simple">
<li>Select a complete propyl chain. Perform this selection in the 3D view.</li>
<li>Activate the function <code class="docutils literal"><span class="pre">Object</span> <span class="pre">-&gt;</span> <span class="pre">Arrange</span> <span class="pre">-&gt;</span> <span class="pre">Frame</span></code> or press <code class="docutils literal"><span class="pre">Ctrl-F</span></code>.</li>
<li>Select the frame that contains the propyl group. Make sure only the frame is
selected and not its contents.</li>
<li>Add the oxygen atom to the selection by clicking on it the the 3D view with
the middle mouse button.</li>
<li>Start an interactive rotation by dragging in the 3D view while holding the
<code class="docutils literal"><span class="pre">Ctrl</span></code> key pressed. You will see that the oxygen atom acts as a rotation
center.</li>
<li>When finished, select only the reference frame of the propyl group and
activate the menu function <code class="docutils literal"><span class="pre">Object</span> <span class="pre">-&gt;</span> <span class="pre">Arrange</span> <span class="pre">-&gt;</span> <span class="pre">Unframe</span> <span class="pre">(absolute)</span></code> or
press <code class="docutils literal"><span class="pre">Ctrl-Shift-F</span></code>.</li>
</ol>
</div>
<div class="section" id="pseudo-rotations">
<h2>4.3.3. Pseudo rotations<a class="headerlink" href="#pseudo-rotations" title="Permalink to this headline">¶</a></h2>
<p>Although the rotations in the previous section are rather trivial and probably
supported in many similar programs (?), this section describes more complex
cases that demonstrate the advantage of having multiple reference frames. To
keep this example a simple as possible, we will work with a THF model
(<a class="reference download internal" href="_downloads/thf.xyz" download=""><code class="xref download docutils literal"><span class="pre">thf.xyz</span></code></a>). Proceed along the following lines:</p>
<ol class="arabic">
<li><p class="first">Load <a class="reference download internal" href="_downloads/thf.xyz" download=""><code class="xref download docutils literal"><span class="pre">thf.xyz</span></code></a> and add the bonds.</p>
</li>
<li><dl class="first docutils">
<dt>Select the two carbon atoms next to the oxygen atom. Activate the function</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">Object</span> <span class="pre">-&gt;</span> <span class="pre">Connect</span> <span class="pre">-&gt;</span> <span class="pre">Arrow</span></code>. This is our first rotation axis.</p>
</dd>
</dl>
</li>
<li><p class="first">The second rotation axis is a bit more complex.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>First add a box to the center of the reference frame: Select the global
reference frame in the tree view and activate <code class="docutils literal"><span class="pre">Object</span> <span class="pre">-&gt;</span> <span class="pre">Add</span> <span class="pre">-&gt;</span> <span class="pre">Box</span></code>.</li>
<li>The box is selected. For reasons of clarity, change to box color to
orange via <code class="docutils literal"><span class="pre">Object</span> <span class="pre">-&gt;</span> <span class="pre">Properties</span></code> or by pressing Ctrl-E. The color field
is located in the <code class="docutils literal"><span class="pre">Markup</span></code> tab page. Click <code class="docutils literal"><span class="pre">OK</span></code> when done.</li>
<li>Select both the oxygen atom and the orange box.</li>
<li>Activate the function <code class="docutils literal"><span class="pre">Object</span> <span class="pre">-&gt;</span> <span class="pre">Connect</span> <span class="pre">-&gt;</span> <span class="pre">Arrow</span></code>. This is our second
rotation axis.</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">Next we will put the part of the molecule we want to rotate in a separate
reference frame. Therefore select the oxygen atom, the neighboring carbon
atoms, the hydrogen atoms connected to these carbon atoms, and the bonds
between them. Press <code class="docutils literal"><span class="pre">Ctfl-F</span></code> to create the new reference frame.</p>
</li>
</ol>
<p>At this point your model should be similar to this figure:</p>
<div class="figure align-center" id="id4">
<img alt="_images/zeobuilder_pseudo_rotation1.png" src="_images/zeobuilder_pseudo_rotation1.png" />
<p class="caption"><span class="caption-text">THF, an orange box and two rotation axes.</span></p>
</div>
<p>Now we are ready to make two types of rotations:</p>
<ol class="lowerroman simple">
<li>Select the new reference frame and the first rotation axis. Perform an
interactive rotation. This type of rotation brings the THF molecule in the
envelope conformation.</li>
<li>Select the new reference frame and the second rotation axis. Perform an
interactive rotation. Such a rotation changes to geometry into the twist
conformation.</li>
</ol>
<p>One can save the new geometries to different XYZ files and run geometry
optimizations to see if such conformers are stable.</p>
<p>From this example it should be clear that Zeobuilder is capable of performing
any kind of rotation. One can freely define the rotation axis and the part of
the molecule that needs to be rotated. Creativity is the last ingredient to get
the work done.</p>
</div>
<div class="section" id="advanced-selections">
<h2>4.3.4. Advanced selections<a class="headerlink" href="#advanced-selections" title="Permalink to this headline">¶</a></h2>
<p>When working with large models, manually selecting a specific set of atoms (or
other objects) quickly becomes an intractable task. Zeobuilder can automatically
make complex selections based on filter expressions to surmount this potential
difficulty. Load the model <a class="reference download internal" href="_downloads/precursor.zml" download=""><code class="xref download docutils literal"><span class="pre">precursor.zml</span></code></a>.
Select the global reference frame and activate the menu function <code class="docutils literal"><span class="pre">Select</span> <span class="pre">-&gt;</span>
<span class="pre">Children</span> <span class="pre">by</span> <span class="pre">expression</span></code>. A popup dialog will appear that looks similar to figure
A3.6. One can enter a valid python expression in the big (white) text entry that
will be applied to all child nodes of the selected container object. In this
example, the selected container is the global reference frame. If the expression
evaluates to True, the child node is selected, otherwise, the child is not
selected. Here are a few expressions to get you started:</p>
<ul class="simple">
<li><strong>All atoms:</strong> <code class="docutils literal"><span class="pre">isinstance(node,</span> <span class="pre">Atom)</span></code></li>
<li><strong>All bonds:</strong> <code class="docutils literal"><span class="pre">isinstance(node,</span> <span class="pre">Bond)</span></code></li>
<li><strong>All hydrogen atoms:</strong> <cite>isinstance(node, Atom) and node.number == 1`</cite></li>
<li><strong>All atoms connected to one or more hydrogen atoms:</strong> <code class="docutils literal"><span class="pre">isinstance(node,</span>
<span class="pre">Atom)</span> <span class="pre">and</span> <span class="pre">reduce(lambda</span> <span class="pre">x,y:</span> <span class="pre">x</span> <span class="pre">or</span> <span class="pre">y,</span> <span class="pre">(neighbor.number</span> <span class="pre">==</span> <span class="pre">1</span> <span class="pre">for</span> <span class="pre">neighbor</span> <span class="pre">in</span>
<span class="pre">node.yield_neighbors()),</span> <span class="pre">False)</span></code></li>
</ul>
<p>The expressions in Zeobuilder are ordinary python expressions. Python evaluates
boolean expressions with the <a class="reference external" href="http://en.wikipedia.org/wiki/Lazy_evaluation">Lazy evaluation</a> technique. This means that for
the evaluations of <cite>X and Y</cite>, expression Y will only be evaluated if X evaluates
to True. This is different from low level languages such as C and Fortran, where
lazy evaluations have to be implemented explicitly with nested if clauses. This
means that the following expression will not work in general:</p>
<ul class="simple">
<li><strong>All hydrogen atoms (does not work in general):</strong> <code class="docutils literal"><span class="pre">node.number</span> <span class="pre">==</span> <span class="pre">1</span> <span class="pre">and</span> <span class="pre">isinstance(node,</span> <span class="pre">Atom)</span></code></li>
</ul>
<p>For example, when the selected frame also contains bond objects, which don&#8217;t
have a <code class="docutils literal"><span class="pre">number</span></code> attribute, Zeobuilder will generate an error message when the
former expression is used.</p>
<div class="figure align-center" id="id5">
<img alt="_images/dialog_select_children_by_expression.png" src="_images/dialog_select_children_by_expression.png" />
<p class="caption"><span class="caption-text">The popup dialog of the menu function <code class="docutils literal"><span class="pre">Select</span> <span class="pre">-&gt;</span> <span class="pre">Children</span> <span class="pre">by</span> <span class="pre">expression</span></code></span></p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The <a class="reference external" href="http://en.wikipedia.org/wiki/API">API</a> of the filter expressions is
not settled yet, nor is it extensively documented. There is no guarantee
that these example will work in all future versions of Zeobuilder.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4.3. Common tasks</a><ul>
<li><a class="reference internal" href="#adding-bonds-to-the-model">4.3.1. Adding bonds to the model</a></li>
<li><a class="reference internal" href="#internal-rotations">4.3.2. Internal rotations</a></li>
<li><a class="reference internal" href="#pseudo-rotations">4.3.3. Pseudo rotations</a></li>
<li><a class="reference internal" href="#advanced-selections">4.3.4. Advanced selections</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tut_basic_getting_started.html"
                        title="previous chapter">4.2. Getting started</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tut_basic_measurements.html"
                        title="next chapter">4.4. Measurements</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tut_basic_common_tasks.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tut_basic_measurements.html" title="4.4. Measurements"
             >next</a> |</li>
        <li class="right" >
          <a href="tut_basic_getting_started.html" title="4.2. Getting started"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Zeobuilder 0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tut_basic.html" >4. Zeobuilder Tutorial &#8211; Getting started</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012, Toon Verstraelen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>